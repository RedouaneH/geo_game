<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoQuiz - Jeu de G√©ographie Multijoueur</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- √âcran d'accueil - Choix du mode -->
    <div id="mode-screen" class="screen active">
        <div class="welcome-container">
            <div class="logo">
                <span class="logo-icon">üåç</span>
                <h1>GeoQuiz</h1>
            </div>
            <p class="tagline">Testez vos connaissances g√©ographiques !</p>
            
            <div class="mode-section">
                <h2>Choisissez votre mode de jeu</h2>
                <div class="mode-cards">
                    <div class="mode-card" id="solo-mode-btn">
                        <div class="card-icon">üéØ</div>
                        <h3>Solo</h3>
                        <p>Jouez seul et battez votre record personnel</p>
                    </div>
                    <div class="mode-card" id="multi-mode-btn">
                        <div class="card-icon">üë•</div>
                        <h3>Multijoueur</h3>
                        <p>Affrontez vos amis en temps r√©el</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- √âcran Solo - S√©lection difficult√© -->
    <div id="welcome-screen" class="screen">
        <div class="welcome-container">
            <div class="logo">
                <span class="logo-icon">üåç</span>
                <h1>GeoQuiz</h1>
            </div>
            <p class="tagline">Mode Solo</p>
            
            <div class="difficulty-section">
                <h2>Choisissez votre niveau</h2>
                <div class="difficulty-cards">
                    <div class="difficulty-card" data-difficulty="easy">
                        <div class="card-icon">üå±</div>
                        <h3>Facile</h3>
                        <p>Pays c√©l√®bres ‚Ä¢ Aide visuelle ‚Ä¢ Temps illimit√©</p>
                    </div>
                    <div class="difficulty-card" data-difficulty="medium">
                        <div class="card-icon">üåø</div>
                        <h3>Moyen</h3>
                        <p>Tous les continents ‚Ä¢ Moins d'indices ‚Ä¢ 30 secondes</p>
                    </div>
                    <div class="difficulty-card" data-difficulty="hard">
                        <div class="card-icon">üå≤</div>
                        <h3>Difficile</h3>
                        <p>Pays obscurs ‚Ä¢ Aucun indice ‚Ä¢ 15 secondes</p>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button id="back-to-mode-btn" class="btn-secondary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                    </svg>
                    <span>Retour</span>
                </button>
                <button id="start-btn" class="btn-primary" disabled>
                    <span>Commencer l'aventure</span>
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- √âcran Multijoueur - Lobby -->
    <div id="lobby-screen" class="screen">
        <div class="welcome-container">
            <div class="logo">
                <span class="logo-icon">üë•</span>
                <h1>Multijoueur</h1>
            </div>
            
            <div class="lobby-section">
                <div class="username-input-container">
                    <label for="username-input">Votre pseudo</label>
                    <input type="text" id="username-input" placeholder="Entrez votre pseudo" maxlength="15">
                </div>
                
                <div class="lobby-options">
                    <div class="lobby-card" id="create-room-section">
                        <h3>Cr√©er un salon</h3>
                        <p>Cr√©ez un salon et invitez vos amis</p>
                        <div class="difficulty-select">
                            <label>Difficult√© :</label>
                            <select id="room-difficulty">
                                <option value="easy">Facile</option>
                                <option value="medium" selected>Moyen</option>
                                <option value="hard">Difficile</option>
                            </select>
                        </div>
                        <button id="create-room-btn" class="btn-primary">
                            <span>Cr√©er le salon</span>
                        </button>
                    </div>
                    
                    <div class="lobby-divider">
                        <span>OU</span>
                    </div>
                    
                    <div class="lobby-card" id="join-room-section">
                        <h3>Rejoindre un salon</h3>
                        <p>Entrez le code du salon</p>
                        <input type="text" id="room-code-input" placeholder="CODE" maxlength="6" class="room-code-input">
                        <button id="join-room-btn" class="btn-primary">
                            <span>Rejoindre</span>
                        </button>
                    </div>
                </div>
                
                <div id="lobby-error" class="error-message hidden"></div>
            </div>

            <button id="back-to-mode-btn-2" class="btn-secondary btn-back-lobby">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                </svg>
                <span>Retour</span>
            </button>
        </div>
    </div>

    <!-- √âcran Salle d'attente -->
    <div id="waiting-room-screen" class="screen">
        <div class="waiting-room-container">
            <div class="room-header">
                <h1>Salon de jeu</h1>
                <div class="room-code-display">
                    <span>Code :</span>
                    <span id="display-room-code" class="room-code">XXXXXX</span>
                    <button id="copy-code-btn" class="btn-icon" title="Copier le code">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/>
                        </svg>
                    </button>
                </div>
                <div class="room-difficulty-badge" id="room-difficulty-display">Moyen</div>
            </div>

            <!-- Param√®tres de la partie (Host uniquement) -->
            <div id="room-settings" class="room-settings">
                <div class="setting-item">
                    <label for="setting-questions">Questions</label>
                    <select id="setting-questions">
                        <option value="2">2 questions</option>
                        <option value="5">5 questions</option>
                        <option value="10" selected>10 questions</option>
                        <option value="15">15 questions</option>
                        <option value="20">20 questions</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="setting-time">Temps par question</label>
                    <select id="setting-time">
                        <option value="0">Illimit√©</option>
                        <option value="10">10 secondes</option>
                        <option value="15">15 secondes</option>
                        <option value="30" selected>30 secondes</option>
                        <option value="45">45 secondes</option>
                        <option value="60">60 secondes</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="setting-difficulty">Difficult√©</label>
                    <select id="setting-difficulty">
                        <option value="easy">Facile (Pays connus)</option>
                        <option value="medium" selected>Moyen (Tous pays)</option>
                        <option value="hard">Difficile (Pays obscurs)</option>
                    </select>
                </div>
            </div>
            
            <div class="players-section">
                <h2>Joueurs <span id="players-count">(1/8)</span></h2>
                <div id="players-list" class="players-list">
                    <!-- Joueurs ajout√©s dynamiquement -->
                </div>
            </div>
            
            <div class="waiting-room-actions">
                <button id="leave-room-btn" class="btn-secondary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M19,3H5C3.89,3 3,3.89 3,5V9H5V5H19V19H5V15H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10.08,15.58L11.5,17L16.5,12L11.5,7L10.08,8.41L12.67,11H3V13H12.67L10.08,15.58Z"/>
                    </svg>
                    <span>Quitter</span>
                </button>
                <button id="start-multi-game-btn" class="btn-primary" disabled>
                    <span>Lancer la partie</span>
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                    </svg>
                </button>
            </div>
            
            <p id="waiting-message" class="waiting-message">En attente du lancement par l'h√¥te...</p>
        </div>
    </div>

    <!-- √âcran de jeu -->
    <div id="game-screen" class="screen">
        <header class="game-header">
            <div class="header-left">
                <button id="back-btn" class="btn-icon" title="Retour au menu">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                    </svg>
                </button>
                <div class="game-info">
                    <span class="difficulty-badge" id="current-difficulty">-</span>
                    <span class="round-info">Question <span id="current-round">-</span>/-</span>
                </div>
            </div>
            <div class="header-center">
                <div class="country-prompt">
                    <span>Trouvez</span>
                    <h2 id="country-name">-</h2>
                </div>
            </div>
            <div class="header-right">
                <div class="score-display">
                    <span class="score-label">Score</span>
                    <span class="score-value" id="score">0</span>
                </div>
                <div class="timer-display" id="timer-container">
                    <svg class="timer-ring" viewBox="0 0 36 36">
                        <path class="timer-ring-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                        <path class="timer-ring-progress" id="timer-progress" stroke-dasharray="100, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                    </svg>
                    <span id="timer">-</span>
                </div>
            </div>
        </header>

        <div id="map-container">
            <div id="map"></div>
            <div id="hint-container" class="hint-box">
                <span class="hint-icon">üí°</span>
                <span id="hint-text">Indice: Ce pays est en Europe</span>
            </div>
        </div>

        <!-- R√©sultat apr√®s chaque r√©ponse (Solo uniquement) -->
        <div id="result-overlay" class="overlay hidden">
            <div class="result-card">
                <div class="result-emoji" id="result-emoji">üéØ</div>
                <h2 id="result-title">Excellent !</h2>
                <p id="result-distance">Vous √©tiez √† 150 km</p>
                <div class="result-points">
                    <span>+</span><span id="result-points">950</span><span> points</span>
                </div>
                <button id="next-btn" class="btn-primary">
                    <span>Question suivante</span>
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Indicateur d'enregistrement (Multi) -->
        <div id="multi-registered-overlay" class="multi-registered-overlay hidden">
            <div class="registered-card">
                <div class="registered-icon">‚úÖ</div>
                <p id="registered-status">R√©ponse enregistr√©e ! Vous pouvez cliquer ailleurs pour modifier.</p>
                <div class="registered-counter">
                    <span id="registered-count">0</span>/<span id="total-players-game">0</span> ont r√©pondu
                </div>
            </div>
        </div>
    </div>

    <!-- √âcran de fin Solo -->
    <div id="end-screen" class="screen">
        <div class="end-container">
            <div class="confetti" id="confetti"></div>
            <div class="trophy" id="trophy">üèÜ</div>
            <h1>Partie termin√©e !</h1>
            <div class="final-score">
                <span class="final-score-label">Score final</span>
                <span class="final-score-value" id="final-score">0</span>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-value" id="stat-perfect">0</span>
                    <span class="stat-label">Parfaits</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="stat-good">0</span>
                    <span class="stat-label">Bons</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="stat-average">0</span>
                    <span class="stat-label">Moyens</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="stat-missed">0</span>
                    <span class="stat-label">Rat√©s</span>
                </div>
            </div>
            <div class="end-buttons">
                <button id="replay-btn" class="btn-primary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                    </svg>
                    <span>Rejouer</span>
                </button>
                <button id="menu-btn" class="btn-secondary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                    </svg>
                    <span>Menu principal</span>
                </button>
            </div>
        </div>
    </div>

    <!-- √âcran de r√©vision des r√©sultats (Multi) -->
    <div id="review-screen" class="screen">
        <div class="review-container">
            <div class="review-header">
                <h1>üìä R√©vision des r√©sultats</h1>
                <p id="review-round-info" class="review-round-info">Question -/-</p>
            </div>
            
            <div class="review-content">
                <div class="review-player-card">
                    <h2 id="review-player-info" class="review-player-name">Joueur (1/4)</h2>
                    <div class="review-country">
                        <span>Pays recherch√© :</span>
                        <strong id="review-country-name">France</strong>
                    </div>
                </div>
                
                <div class="review-result-section">
                    <div class="review-emoji" id="review-result-emoji">üéØ</div>
                    <h3 id="review-result-title" class="review-result-title excellent">Excellent !</h3>
                    <p id="review-distance" class="review-distance">Distance: 150 km</p>
                    <div class="review-points" id="review-points">+950 points</div>
                </div>
                
                <div id="review-map-container" class="review-map-container">
                    <div id="review-map" class="review-map"></div>
                </div>
            </div>
            
            <div class="review-controls">
                <div id="review-host-controls" class="review-host-controls">
                    <button id="skip-question-btn" class="btn-secondary">
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path fill="currentColor" d="M6,18L14.5,12L6,6M8,9.86L11.03,12L8,14.14M16,6H18V18H16"/>
                        </svg>
                        <span>Passer √† la question suivante</span>
                    </button>
                    <button id="next-player-btn" class="btn-primary">
                        <span>Joueur suivant</span>
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path fill="currentColor" d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                        </svg>
                    </button>
                </div>
                <p id="review-waiting-message" class="review-waiting-message">En attente de l'h√¥te...</p>
            </div>
        </div>
    </div>

    <!-- √âcran de fin Multijoueur -->
    <div id="multi-end-screen" class="screen">
        <div class="end-container multi-end">
            <div class="confetti" id="multi-confetti"></div>
            
            <div class="podium-section">
                <h1 id="multi-end-title">üéâ Partie termin√©e !</h1>
                
                <div class="podium">
                    <div class="podium-place second" id="podium-2">
                        <div class="podium-avatar">ü•à</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">0</div>
                        <div class="podium-block">2</div>
                    </div>
                    <div class="podium-place first" id="podium-1">
                        <div class="podium-avatar">ü•á</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">0</div>
                        <div class="podium-block">1</div>
                    </div>
                    <div class="podium-place third" id="podium-3">
                        <div class="podium-avatar">ü•â</div>
                        <div class="podium-name">-</div>
                        <div class="podium-score">0</div>
                        <div class="podium-block">3</div>
                    </div>
                </div>
                
                <div class="full-leaderboard" id="full-leaderboard">
                    <!-- Autres joueurs si > 3 -->
                </div>
            </div>
            
            <div class="end-buttons">
                <button id="multi-replay-btn" class="btn-primary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
                    </svg>
                    <span>Salle d'attente</span>
                </button>
                <button id="multi-menu-btn" class="btn-secondary">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                    </svg>
                    <span>Menu principal</span>
                </button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="countries.js"></script>
    <script src="game.js"></script>
</body>
</html>
